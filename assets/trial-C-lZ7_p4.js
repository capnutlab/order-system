import{a as e,c as t,d as n,f as r,g as i,h as a,i as o,l as s,m as c,n as l,o as u,p as d,r as f,s as p,t as m,u as h}from"./jsx-runtime-D6M7Vawd.js";var g=c(),_=i(a(),1),v={ORDERS:`order-system-orders`,MASTERS:`order-system-masters`};const y=()=>{try{let e=localStorage.getItem(v.ORDERS);return e?JSON.parse(e):[]}catch(e){return console.error(`注文データの読み込みエラー:`,e),[]}},b=e=>{try{localStorage.setItem(v.ORDERS,JSON.stringify(e))}catch(e){throw console.error(`注文データの保存エラー:`,e),e}},x=()=>{try{let e=localStorage.getItem(v.MASTERS);return e?JSON.parse(e):{clients:[],products:[],materials:[]}}catch(e){return console.error(`マスタデータの読み込みエラー:`,e),{clients:[],products:[],materials:[]}}},S=e=>{try{localStorage.setItem(v.MASTERS,JSON.stringify(e))}catch(e){throw console.error(`マスタデータの保存エラー:`,e),e}},C=e=>{try{let t=y().filter(t=>t.id!==e);return b(t),t}catch(e){throw console.error(`注文削除エラー:`,e),e}};var w=m(),T={IN_PROGRESS:`進行中`,COMPLETED:`完了`},E={getDaysUntilDeadline:e=>{let t=new Date;t.setHours(0,0,0,0);let n=new Date(e);return n.setHours(0,0,0,0),Math.ceil((n-t)/(1e3*60*60*24))},getAlertLevel:e=>e<0?`overdue`:e<=3?`urgent`:e<=7?`warning`:`normal`},D={getRowColorClass:e=>{let t={overdue:`bg-red-50`,urgent:`bg-orange-50`,warning:`bg-yellow-50`,normal:`bg-white`};return t[e]||t.normal},getDaysTextColorClass:e=>e<0?`text-red-600`:e<=3?`text-orange-600`:e<=7?`text-yellow-600`:`text-slate-600`},O=({title:e,type:t,data:i,input:a,setInput:o,addFunc:s,moveUp:c,moveDown:u,deleteMaster:d})=>(0,w.jsxs)(`div`,{className:`bg-white border border-slate-200 p-5`,children:[(0,w.jsx)(`h3`,{className:`text-sm font-semibold text-slate-900 mb-4 tracking-wide uppercase`,children:e}),(0,w.jsxs)(`div`,{className:`flex gap-2 mb-4`,children:[(0,w.jsx)(`input`,{type:`text`,placeholder:`${e}を入力`,value:a,onChange:e=>o(e.target.value),onKeyPress:e=>e.key===`Enter`&&s(),className:`flex-1 px-3 py-2 text-sm border border-slate-300 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none`}),(0,w.jsx)(`button`,{onClick:s,className:`px-4 py-2 bg-slate-900 text-white text-sm hover:bg-slate-800`,children:`追加`})]}),(0,w.jsx)(`div`,{className:`space-y-1 max-h-48 overflow-y-auto`,children:i.length===0?(0,w.jsx)(`div`,{className:`text-center py-6 text-slate-400`,children:(0,w.jsx)(`p`,{className:`text-xs`,children:`未登録`})}):i.map((e,a)=>(0,w.jsxs)(`div`,{className:`flex justify-between items-center bg-slate-50 px-3 py-2 hover:bg-slate-100 group`,children:[(0,w.jsx)(`span`,{className:`text-sm text-slate-700`,children:e}),(0,w.jsxs)(`div`,{className:`flex gap-1 opacity-0 group-hover:opacity-100`,children:[(0,w.jsx)(`button`,{onClick:()=>c(t,a),disabled:a===0,className:`p-1 ${a===0?`text-slate-300`:`text-slate-600 hover:text-slate-900`}`,children:(0,w.jsx)(n,{size:14})}),(0,w.jsx)(`button`,{onClick:()=>u(t,a),disabled:a===i.length-1,className:`p-1 ${a===i.length-1?`text-slate-300`:`text-slate-600 hover:text-slate-900`}`,children:(0,w.jsx)(r,{size:14})}),(0,w.jsx)(`button`,{onClick:()=>d(t,e),className:`p-1 text-slate-600 hover:text-red-600 ml-1`,children:(0,w.jsx)(l,{size:14})})]})]},a))}),(0,w.jsx)(`div`,{className:`mt-4 pt-4 border-t border-slate-200`,children:(0,w.jsxs)(`p`,{className:`text-xs text-slate-500 text-right`,children:[i.length,` 件`]})})]}),k=({commonData:e,setCommonData:t,items:n,setItems:r,masters:i,onSubmit:a,onCancel:o})=>{let[s,c]=(0,_.useState)(!1),[l,u]=(0,_.useState)([!1,!1,!1,!1,!1]),d=i.clients.filter(t=>!e.clientName||t.toLowerCase().includes(e.clientName.toLowerCase())),f=e=>{let t=n[e].size.toLowerCase();return i.products.filter(r=>!n[e].size||r.toLowerCase().includes(t))};return(0,w.jsxs)(`div`,{className:`bg-white border border-slate-200 p-6 mb-6`,children:[(0,w.jsx)(`h3`,{className:`text-sm font-semibold text-slate-900 mb-4 tracking-wide uppercase`,children:`新規注文（5件一括登録）`}),(0,w.jsxs)(`div`,{className:`mb-6 pb-6 border-b border-slate-200`,children:[(0,w.jsx)(`p`,{className:`text-xs text-slate-500 mb-3 uppercase tracking-wide`,children:`共通項目`}),(0,w.jsxs)(`div`,{className:`grid grid-cols-3 gap-4`,children:[(0,w.jsx)(`input`,{type:`text`,placeholder:`注文番号 *`,value:e.orderNumber,onChange:n=>t({...e,orderNumber:n.target.value}),className:`px-3 py-2 text-sm border border-slate-300 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none`}),(0,w.jsxs)(`div`,{className:`relative`,children:[(0,w.jsx)(`input`,{type:`text`,placeholder:`顧客名`,value:e.clientName,onChange:n=>{t({...e,clientName:n.target.value}),c(!0)},onFocus:()=>c(!0),onBlur:()=>setTimeout(()=>c(!1),200),className:`px-3 py-2 text-sm border border-slate-300 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none w-full`}),s&&d.length>0&&(0,w.jsx)(`div`,{className:`absolute z-20 w-full mt-1 bg-white border border-slate-300 rounded shadow-lg max-h-60 overflow-y-auto`,children:d.map((n,r)=>(0,w.jsx)(`div`,{onMouseDown:r=>{r.preventDefault(),t({...e,clientName:n}),c(!1)},className:`px-3 py-2 hover:bg-slate-100 cursor-pointer text-sm`,children:n},r))})]}),(0,w.jsx)(`input`,{type:`date`,value:e.deadline,onChange:n=>t({...e,deadline:n.target.value}),className:`px-3 py-2 text-sm border border-slate-300 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none`})]})]}),(0,w.jsxs)(`div`,{className:`mb-6`,children:[(0,w.jsx)(`p`,{className:`text-xs text-slate-500 mb-3 uppercase tracking-wide`,children:`個別項目（材質・サイズ・数量）`}),(0,w.jsx)(`div`,{className:`space-y-3`,children:n.map((e,t)=>{let a=f(t);return(0,w.jsxs)(`div`,{className:`grid grid-cols-4 gap-4 items-center`,children:[(0,w.jsxs)(`span`,{className:`text-xs text-slate-500 font-medium`,children:[`#`,t+1]}),(0,w.jsxs)(`select`,{value:e.material,onChange:e=>{let i=[...n];i[t].material=e.target.value,r(i)},className:`px-3 py-2 text-sm border border-slate-300 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none`,children:[(0,w.jsx)(`option`,{value:``,children:`材質`}),i.materials.map((e,t)=>(0,w.jsx)(`option`,{value:e,children:e},t))]}),(0,w.jsxs)(`div`,{className:`relative`,children:[(0,w.jsx)(`input`,{type:`text`,placeholder:`サイズ`,value:e.size,onChange:e=>{let i=[...n];i[t].size=e.target.value,r(i);let a=[...l];a[t]=!0,u(a)},onFocus:()=>{let e=[...l];e[t]=!0,u(e)},onBlur:()=>setTimeout(()=>{let e=[...l];e[t]=!1,u(e)},200),className:`px-3 py-2 text-sm border border-slate-300 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none w-full`}),l[t]&&a.length>0&&(0,w.jsx)(`div`,{className:`absolute z-20 w-full mt-1 bg-white border border-slate-300 rounded shadow-lg max-h-60 overflow-y-auto`,children:a.map((e,i)=>(0,w.jsx)(`div`,{onMouseDown:i=>{i.preventDefault();let a=[...n];a[t].size=e,r(a);let o=[...l];o[t]=!1,u(o)},className:`px-3 py-2 hover:bg-slate-100 cursor-pointer text-sm`,children:e},i))})]}),(0,w.jsx)(`input`,{type:`number`,placeholder:`数量`,value:e.quantity,onChange:e=>{let i=[...n];i[t].quantity=e.target.value,r(i)},className:`px-3 py-2 text-sm border border-slate-300 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none`})]},t)})})]}),(0,w.jsxs)(`div`,{className:`flex gap-3 mt-4`,children:[(0,w.jsx)(`button`,{onClick:a,className:`px-6 py-2 bg-slate-900 text-white text-sm hover:bg-slate-800`,children:`追加`}),(0,w.jsx)(`button`,{onClick:o,className:`px-6 py-2 border border-slate-300 text-slate-700 text-sm hover:bg-slate-50`,children:`キャンセル`})]})]})},A=({orders:e,onRowClick:n})=>e.length===0?(0,w.jsxs)(`div`,{className:`p-16 text-center`,children:[(0,w.jsx)(t,{size:48,className:`mx-auto mb-4 text-slate-300`}),(0,w.jsx)(`p`,{className:`text-slate-400 text-sm`,children:`注文データがありません`})]}):(0,w.jsxs)(`table`,{className:`w-full`,children:[(0,w.jsx)(`thead`,{className:`bg-slate-900 text-white`,children:(0,w.jsxs)(`tr`,{children:[(0,w.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium uppercase tracking-wider`,children:`注文番号`}),(0,w.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium uppercase tracking-wider`,children:`顧客名`}),(0,w.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium uppercase tracking-wider`,children:`商品名`}),(0,w.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium uppercase tracking-wider`,children:`材質`}),(0,w.jsx)(`th`,{className:`px-4 py-3 text-center text-xs font-medium uppercase tracking-wider`,children:`数量`}),(0,w.jsx)(`th`,{className:`px-4 py-3 text-left text-xs font-medium uppercase tracking-wider`,children:`納期`}),(0,w.jsx)(`th`,{className:`px-4 py-3 text-center text-xs font-medium uppercase tracking-wider`,children:`残日数`}),(0,w.jsx)(`th`,{className:`px-4 py-3 text-center text-xs font-medium uppercase tracking-wider`,children:`状態`}),(0,w.jsx)(`th`,{className:`px-4 py-3 text-center text-xs font-medium uppercase tracking-wider`,children:`詳細`})]})}),(0,w.jsx)(`tbody`,{className:`divide-y divide-slate-200`,children:e.sort((e,t)=>e.status===t.status?new Date(e.deadline)-new Date(t.deadline):e.status===T.COMPLETED?1:-1).map(e=>{let t=E.getDaysUntilDeadline(e.deadline),r=E.getAlertLevel(t),i=D.getRowColorClass(r),a=D.getDaysTextColorClass(t);return(0,w.jsxs)(`tr`,{className:`${i} cursor-pointer hover:bg-slate-100`,onClick:()=>n(e),children:[(0,w.jsx)(`td`,{className:`px-4 py-3 text-sm font-mono font-semibold text-slate-900`,children:e.orderNumber}),(0,w.jsx)(`td`,{className:`px-4 py-3 text-sm text-slate-700`,children:e.clientName||`−`}),(0,w.jsx)(`td`,{className:`px-4 py-3 text-sm text-slate-700`,children:e.productName||`−`}),(0,w.jsx)(`td`,{className:`px-4 py-3 text-sm text-slate-700`,children:e.material||`−`}),(0,w.jsx)(`td`,{className:`px-4 py-3 text-sm text-slate-700 text-center font-medium`,children:e.quantity||`−`}),(0,w.jsx)(`td`,{className:`px-4 py-3 text-sm text-slate-700 font-mono`,children:e.deadline}),(0,w.jsx)(`td`,{className:`px-4 py-3 text-center`,children:e.status!==T.COMPLETED&&(0,w.jsx)(`span`,{className:`text-xs font-semibold ${a}`,children:t<0?`${Math.abs(t)}日遅延`:`残り${t}日`})}),(0,w.jsx)(`td`,{className:`px-4 py-3 text-center`,children:(0,w.jsx)(`span`,{className:`px-3 py-1 text-xs font-medium ${e.status===T.COMPLETED?`bg-emerald-100 text-emerald-800`:`bg-slate-100 text-slate-800`}`,children:e.status})}),(0,w.jsx)(`td`,{className:`px-4 py-3 text-center`,children:(0,w.jsx)(`button`,{onClick:t=>{t.stopPropagation(),n(e)},className:`text-slate-400 hover:text-slate-900`,children:(0,w.jsx)(s,{size:16})})})]},e.id)})})]}),j=({order:e,masters:t,onClose:n,onStatusChange:r,onUpdate:i,onDelete:a})=>{let[s,c]=(0,_.useState)(!1),[u,f]=(0,_.useState)({...e}),m=E.getDaysUntilDeadline(u.deadline),g=D.getDaysTextColorClass(m);return(0,w.jsx)(`div`,{className:`fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center p-4 z-50`,onClick:n,children:(0,w.jsxs)(`div`,{className:`bg-white max-w-2xl w-full p-8 border border-slate-200`,onClick:e=>e.stopPropagation(),children:[(0,w.jsxs)(`div`,{className:`flex justify-between items-start mb-6`,children:[(0,w.jsx)(`h2`,{className:`text-lg font-semibold text-slate-900 tracking-wide uppercase`,children:s?`注文編集`:`注文詳細`}),(0,w.jsx)(`button`,{onClick:n,className:`text-slate-400 hover:text-slate-900`,children:(0,w.jsx)(l,{size:20})})]}),s?(0,w.jsxs)(`div`,{className:`space-y-4`,children:[(0,w.jsxs)(`div`,{className:`grid grid-cols-2 gap-4`,children:[(0,w.jsxs)(`div`,{children:[(0,w.jsx)(`label`,{className:`block text-xs text-slate-600 mb-2 uppercase tracking-wide`,children:`注文番号`}),(0,w.jsx)(`input`,{type:`text`,value:u.orderNumber,onChange:e=>f({...u,orderNumber:e.target.value}),className:`w-full px-3 py-2 text-sm border border-slate-300 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none`})]}),(0,w.jsxs)(`div`,{children:[(0,w.jsx)(`label`,{className:`block text-xs text-slate-600 mb-2 uppercase tracking-wide`,children:`状態`}),(0,w.jsxs)(`select`,{value:u.status,onChange:e=>f({...u,status:e.target.value}),className:`w-full px-3 py-2 text-sm border border-slate-300 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none`,children:[(0,w.jsx)(`option`,{value:T.IN_PROGRESS,children:T.IN_PROGRESS}),(0,w.jsx)(`option`,{value:T.COMPLETED,children:T.COMPLETED})]})]})]}),(0,w.jsxs)(`div`,{className:`grid grid-cols-2 gap-4`,children:[(0,w.jsxs)(`div`,{children:[(0,w.jsx)(`label`,{className:`block text-xs text-slate-600 mb-2 uppercase tracking-wide`,children:`顧客名`}),(0,w.jsx)(`input`,{type:`text`,list:`edit-client-list`,value:u.clientName,onChange:e=>f({...u,clientName:e.target.value}),className:`w-full px-3 py-2 text-sm border border-slate-300 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none`}),(0,w.jsx)(`datalist`,{id:`edit-client-list`,children:t.clients.map((e,t)=>(0,w.jsx)(`option`,{value:e},t))})]}),(0,w.jsxs)(`div`,{children:[(0,w.jsx)(`label`,{className:`block text-xs text-slate-600 mb-2 uppercase tracking-wide`,children:`商品名`}),(0,w.jsx)(`input`,{type:`text`,list:`edit-product-list`,value:u.productName,onChange:e=>f({...u,productName:e.target.value}),className:`w-full px-3 py-2 text-sm border border-slate-300 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none`}),(0,w.jsx)(`datalist`,{id:`edit-product-list`,children:t.products.map((e,t)=>(0,w.jsx)(`option`,{value:e},t))})]})]}),(0,w.jsxs)(`div`,{className:`grid grid-cols-2 gap-4`,children:[(0,w.jsxs)(`div`,{children:[(0,w.jsx)(`label`,{className:`block text-xs text-slate-600 mb-2 uppercase tracking-wide`,children:`材質`}),(0,w.jsxs)(`select`,{value:u.material,onChange:e=>f({...u,material:e.target.value}),className:`w-full px-3 py-2 text-sm border border-slate-300 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none`,children:[(0,w.jsx)(`option`,{value:``,children:`材質を選択`}),t.materials.map((e,t)=>(0,w.jsx)(`option`,{value:e,children:e},t))]})]}),(0,w.jsxs)(`div`,{children:[(0,w.jsx)(`label`,{className:`block text-xs text-slate-600 mb-2 uppercase tracking-wide`,children:`数量`}),(0,w.jsx)(`input`,{type:`number`,value:u.quantity,onChange:e=>f({...u,quantity:e.target.value}),className:`w-full px-3 py-2 text-sm border border-slate-300 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none`})]})]}),(0,w.jsxs)(`div`,{children:[(0,w.jsx)(`label`,{className:`block text-xs text-slate-600 mb-2 uppercase tracking-wide`,children:`納期`}),(0,w.jsx)(`input`,{type:`date`,value:u.deadline,onChange:e=>f({...u,deadline:e.target.value}),className:`w-full px-3 py-2 text-sm border border-slate-300 focus:border-slate-900 focus:ring-1 focus:ring-slate-900 outline-none`})]})]}):(0,w.jsxs)(`div`,{className:`space-y-6`,children:[(0,w.jsxs)(`div`,{className:`grid grid-cols-2 gap-6`,children:[(0,w.jsxs)(`div`,{children:[(0,w.jsx)(`p`,{className:`text-xs text-slate-500 uppercase tracking-wide mb-1`,children:`注文番号`}),(0,w.jsx)(`p`,{className:`text-lg font-semibold font-mono text-slate-900`,children:u.orderNumber})]}),(0,w.jsxs)(`div`,{children:[(0,w.jsx)(`p`,{className:`text-xs text-slate-500 uppercase tracking-wide mb-1`,children:`状態`}),(0,w.jsx)(`span`,{className:`inline-block px-3 py-1 text-xs font-medium ${u.status===T.COMPLETED?`bg-emerald-100 text-emerald-800`:`bg-slate-100 text-slate-800`}`,children:u.status})]})]}),(0,w.jsxs)(`div`,{className:`grid grid-cols-2 gap-6`,children:[(0,w.jsxs)(`div`,{children:[(0,w.jsx)(`p`,{className:`text-xs text-slate-500 uppercase tracking-wide mb-1`,children:`顧客名`}),(0,w.jsx)(`p`,{className:`text-sm text-slate-900`,children:u.clientName||`−`})]}),(0,w.jsxs)(`div`,{children:[(0,w.jsx)(`p`,{className:`text-xs text-slate-500 uppercase tracking-wide mb-1`,children:`商品名`}),(0,w.jsx)(`p`,{className:`text-sm text-slate-900`,children:u.productName||`−`})]})]}),(0,w.jsxs)(`div`,{className:`grid grid-cols-2 gap-6`,children:[(0,w.jsxs)(`div`,{children:[(0,w.jsx)(`p`,{className:`text-xs text-slate-500 uppercase tracking-wide mb-1`,children:`材質`}),(0,w.jsx)(`p`,{className:`text-sm text-slate-900`,children:u.material||`−`})]}),(0,w.jsxs)(`div`,{children:[(0,w.jsx)(`p`,{className:`text-xs text-slate-500 uppercase tracking-wide mb-1`,children:`数量`}),(0,w.jsx)(`p`,{className:`text-sm text-slate-900`,children:u.quantity||`−`})]})]}),(0,w.jsxs)(`div`,{className:`pt-4 border-t border-slate-200`,children:[(0,w.jsx)(`p`,{className:`text-xs text-slate-500 uppercase tracking-wide mb-2`,children:`納期`}),(0,w.jsxs)(`div`,{className:`flex items-baseline gap-4`,children:[(0,w.jsx)(`p`,{className:`text-lg font-mono font-semibold text-slate-900`,children:u.deadline}),u.status!==T.COMPLETED&&(0,w.jsx)(`span`,{className:`text-sm font-semibold ${g}`,children:m<0?`${Math.abs(m)}日遅延`:`残り${m}日`})]})]})]}),(0,w.jsx)(`div`,{className:`flex flex-col gap-3 mt-8 pt-6 border-t border-slate-200`,children:s?(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(`div`,{className:`flex gap-3`,children:[(0,w.jsxs)(`button`,{onClick:()=>{i(u),c(!1)},className:`flex-1 px-6 py-3 bg-slate-900 text-white text-sm hover:bg-slate-800 flex items-center justify-center gap-2`,children:[(0,w.jsx)(h,{size:16}),`保存`]}),(0,w.jsxs)(`button`,{onClick:()=>{f({...e}),c(!1)},className:`flex-1 px-6 py-3 border border-slate-300 text-slate-700 text-sm hover:bg-slate-50 flex items-center justify-center gap-2`,children:[(0,w.jsx)(l,{size:16}),`キャンセル`]})]})}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(`div`,{className:`flex gap-3`,children:[(0,w.jsxs)(`button`,{onClick:()=>c(!0),className:`flex-1 px-6 py-3 bg-slate-900 text-white text-sm hover:bg-slate-800 flex items-center justify-center gap-2`,children:[(0,w.jsx)(p,{size:16}),`編集`]}),u.status===T.COMPLETED?(0,w.jsxs)(`button`,{onClick:()=>{r(u.id,T.IN_PROGRESS),f({...u,status:T.IN_PROGRESS})},className:`flex-1 px-6 py-3 border border-slate-300 text-slate-700 text-sm hover:bg-slate-50 flex items-center justify-center gap-2`,children:[(0,w.jsx)(d,{size:16}),`進行中に戻す`]}):(0,w.jsxs)(`button`,{onClick:()=>{r(u.id,T.COMPLETED),f({...u,status:T.COMPLETED})},className:`flex-1 px-6 py-3 border border-slate-300 text-slate-700 text-sm hover:bg-slate-50 flex items-center justify-center gap-2`,children:[(0,w.jsx)(h,{size:16}),`完了`]})]}),(0,w.jsxs)(`button`,{onClick:()=>{window.confirm(`この注文を削除してもよろしいですか？`)&&a(u.id)},className:`w-full px-6 py-3 bg-red-600 text-white text-sm hover:bg-red-700 flex items-center justify-center gap-2`,children:[(0,w.jsx)(o,{size:16}),`削除`]})]})})]})})},M={MAX_ORDERS:20,MAX_MASTERS:10};(0,g.createRoot)(document.getElementById(`root`)).render((0,w.jsx)(_.StrictMode,{children:(0,w.jsx)(()=>{let[t,n]=(0,_.useState)([]),[r,i]=(0,_.useState)(!1),[a,o]=(0,_.useState)(null),[s,c]=(0,_.useState)(`orders`),[l,d]=(0,_.useState)({clients:[],products:[],materials:[]}),[p,m]=(0,_.useState)(``),[h,g]=(0,_.useState)(``),[v,D]=(0,_.useState)(``),[N,P]=(0,_.useState)({orderNumber:``,clientName:``,deadline:``}),[F,I]=(0,_.useState)([{material:``,size:``,quantity:``},{material:``,size:``,quantity:``},{material:``,size:``,quantity:``},{material:``,size:``,quantity:``},{material:``,size:``,quantity:``}]);(0,_.useEffect)(()=>{n(y()||[]),d(x()||{clients:[],products:[],materials:[]})},[]);let L=e=>{try{S(e)}catch(e){console.error(`マスタ保存エラー:`,e),alert(`マスタデータの保存に失敗しました`)}},R=e=>{try{let t=y(),n=t.findIndex(t=>t.id===e.id),r;return n>=0?(r=[...t],r[n]=e):r=[...t,e],b(r),r}catch(e){throw console.error(`注文保存エラー:`,e),alert(`注文データの保存に失敗しました`),e}},z=()=>{n(y()||[]),d(x()||{clients:[],products:[],materials:[]}),alert(`データを更新しました`)},B=()=>{let e=p.trim();if(!e)return;if(l.clients.includes(e)){alert(`既に登録されています`),m(``);return}if(l.clients.length>=M.MAX_MASTERS){alert(`お試し版では${M.MAX_MASTERS}件まで登録できます。`),m(``);return}let t={...l,clients:[...l.clients,e]};d(t),L(t),m(``)},V=()=>{let e=h.trim();if(!e)return;if(l.products.includes(e)){alert(`既に登録されています`),g(``);return}if(l.products.length>=M.MAX_MASTERS){alert(`お試し版では${M.MAX_MASTERS}件まで登録できます。`),g(``);return}let t={...l,products:[...l.products,e]};d(t),L(t),g(``)},H=()=>{let e=v.trim();if(!e)return;if(l.materials.includes(e)){alert(`既に登録されています`),D(``);return}if(l.materials.length>=M.MAX_MASTERS){alert(`お試し版では${M.MAX_MASTERS}件まで登録できます。`),D(``);return}let t={...l,materials:[...l.materials,e]};d(t),L(t),D(``)},U=(e,t)=>{if(t===0)return;let n=[...l[e]];[n[t-1],n[t]]=[n[t],n[t-1]];let r={...l,[e]:n};d(r),L(r)},W=(e,t)=>{if(t===l[e].length-1)return;let n=[...l[e]];[n[t],n[t+1]]=[n[t+1],n[t]];let r={...l,[e]:n};d(r),L(r)},G=(e,t)=>{let n={...l,[e]:l[e].filter(e=>e!==t)};d(n),L(n)},K=()=>{if(!N.orderNumber||!N.deadline){alert(`注文番号と納期は必須です`);return}if(t.length>=M.MAX_ORDERS){alert(`お試し版では${M.MAX_ORDERS}件まで登録できます。`);return}let e=F.filter(e=>{let t=e.material&&e.material.trim()!==``,n=e.size&&e.size.trim()!==``,r=e.quantity!==``&&e.quantity!==null&&e.quantity!==void 0;return t||n||r});if(e.length===0){alert(`少なくとも1件の材質・サイズ・数量を入力してください`);return}if(t.length+e.length>M.MAX_ORDERS){let e=M.MAX_ORDERS-t.length;alert(`お試し版では${M.MAX_ORDERS}件まで登録できます。現在${t.length}件登録済みのため、あと${e}件まで追加できます。`);return}let r=e.map((e,t)=>({orderNumber:N.orderNumber,clientName:N.clientName,productName:e.size||``,material:e.material,size:e.size,quantity:e.quantity,deadline:N.deadline,status:T.IN_PROGRESS,id:Date.now()+t,uploadedAt:new Date().toISOString()})),a=[...t,...r];b(a),n(a),P({orderNumber:``,clientName:``,deadline:``}),I([{material:``,size:``,quantity:``},{material:``,size:``,quantity:``},{material:``,size:``,quantity:``},{material:``,size:``,quantity:``},{material:``,size:``,quantity:``}]),i(!1),alert(`${r.length}件の注文を追加しました`)},q=(e,r)=>{let i=t.map(t=>{if(t.id===e){let e={...t,status:r,completedAt:r===T.COMPLETED?new Date().toISOString():null};return R(e),e}return t});n(i),b(i)},J=e=>{n(R(e)),alert(`注文を更新しました`),o(null)},Y=e=>{try{n(C(e)),o(null),alert(`注文を削除しました`)}catch(e){console.error(`削除エラー:`,e),alert(`注文の削除に失敗しました`)}},X=t.filter(e=>e.status===T.COMPLETED?!1:E.getDaysUntilDeadline(e.deadline)<=7);return(0,w.jsx)(`div`,{className:`min-h-screen bg-slate-50 p-6`,children:(0,w.jsxs)(`div`,{className:`max-w-full mx-auto`,children:[(0,w.jsxs)(`div`,{className:`bg-white border border-slate-200 mb-6`,children:[(0,w.jsxs)(`div`,{className:`flex justify-between items-center p-6 border-b border-slate-200`,children:[(0,w.jsxs)(`div`,{children:[(0,w.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,w.jsx)(`h1`,{className:`text-2xl font-semibold text-slate-900 tracking-tight`,children:`注文書納期管理`}),(0,w.jsx)(`span`,{className:`px-2 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded`,children:`お試し版`})]}),(0,w.jsx)(`p`,{className:`text-sm text-slate-500 mt-1`,children:`Order Deadline Management System`}),(0,w.jsxs)(`p`,{className:`text-xs text-slate-400 mt-1`,children:[`注文: `,t.length,`/`,M.MAX_ORDERS,`件 | マスタ: 各`,Object.values(l).reduce((e,t)=>e+t.length,0),`/`,M.MAX_MASTERS*3,`件`]})]}),(0,w.jsxs)(`button`,{onClick:z,className:`px-4 py-2 border border-slate-300 text-slate-700 text-sm hover:bg-slate-50 flex items-center gap-2`,children:[(0,w.jsx)(e,{size:16}),`更新`]})]}),(0,w.jsxs)(`div`,{className:`flex border-b border-slate-200`,children:[(0,w.jsx)(`button`,{onClick:()=>c(`orders`),className:`px-6 py-3 text-sm font-medium ${s===`orders`?`text-slate-900 border-b-2 border-slate-900`:`text-slate-500 hover:text-slate-700`}`,children:`注文管理`}),(0,w.jsx)(`button`,{onClick:()=>c(`masters`),className:`px-6 py-3 text-sm font-medium ${s===`masters`?`text-slate-900 border-b-2 border-slate-900`:`text-slate-500 hover:text-slate-700`}`,children:`マスタ登録`})]}),(0,w.jsx)(`div`,{className:`p-6`,children:s===`masters`?(0,w.jsxs)(`div`,{children:[(0,w.jsx)(`div`,{className:`bg-slate-100 border-l-2 border-slate-900 p-4 mb-6`,children:(0,w.jsx)(`p`,{className:`text-sm text-slate-700`,children:`よく使う顧客名・商品名・材質を事前に登録しておくと、注文追加時に選択できます`})}),(0,w.jsxs)(`div`,{className:`grid grid-cols-1 lg:grid-cols-3 gap-6`,children:[(0,w.jsx)(O,{title:`顧客名`,type:`clients`,data:l.clients,input:p,setInput:m,addFunc:B,moveUp:U,moveDown:W,deleteMaster:G}),(0,w.jsx)(O,{title:`商品名`,type:`products`,data:l.products,input:h,setInput:g,addFunc:V,moveUp:U,moveDown:W,deleteMaster:G}),(0,w.jsx)(O,{title:`材質`,type:`materials`,data:l.materials,input:v,setInput:D,addFunc:H,moveUp:U,moveDown:W,deleteMaster:G})]})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(`button`,{onClick:()=>i(!r),className:`mb-6 px-4 py-2 bg-slate-900 text-white text-sm hover:bg-slate-800 flex items-center gap-2`,children:[(0,w.jsx)(u,{size:16}),`新規注文`]}),r&&(0,w.jsx)(k,{commonData:N,setCommonData:P,items:F,setItems:I,masters:l,onSubmit:K,onCancel:()=>i(!1)}),X.length>0&&(0,w.jsx)(`div`,{className:`mb-6 bg-red-50 border-l-2 border-red-600 p-4`,children:(0,w.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,w.jsx)(f,{className:`text-red-600`,size:20}),(0,w.jsxs)(`p`,{className:`text-sm text-red-800 font-medium`,children:[X.length,`件の注文が納期7日以内です`]})]})})]})})]}),s===`orders`&&(0,w.jsx)(`div`,{className:`bg-white border border-slate-200 overflow-hidden`,children:(0,w.jsx)(A,{orders:t,onRowClick:o})}),a&&(0,w.jsx)(j,{order:a,masters:l,onClose:()=>o(null),onStatusChange:q,onUpdate:J,onDelete:Y})]})})},{})}));